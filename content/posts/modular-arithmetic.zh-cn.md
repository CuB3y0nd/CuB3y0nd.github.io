---
title: 模运算
subtitle: 模运算基础知识简介
date: 2023-08-10T15:28:19+08:00
draft: false
author:
  name: CuB3y0nd
  link:
  email:
  avatar:
description:
keywords:
license:
comment: true
weight: 0
tags:
  - Crypto
categories:
  - Cryptography
hiddenFromHomePage: false
hiddenFromSearch: false
summary:
resources:
  - name: featured-image
    src: featured-image.jpg
  - name: featured-image-preview
    src: featured-image-preview.jpg
toc: true
math: true
lightgallery: false
password:
message:
repost:
  enable: false
  url:
---

模运算基础知识简介

<!--more-->

## 0x01 基础

模运算几乎是所有非对称密码学的一个极其重要的方面。一种常见的称呼方式是 **时钟算术**
——想象现在是十一点。三个小时后就两点了，对吧？我们在模算术中做了同样的事情：

$$11 + 3 = 14 \equiv 2 \mod 12$$

这个式子的含义是：在模数为 $12$ 的情况下，$11 + 3$ 得到的余数是 $2$ 。

本质上，我们将 $11$ 和 $3$ 相加，然后除以 $12$ 并保留余数。这里，$12$ 被称为 **模数**。
$\equiv$ 表示同余，我们说 $14$ 与 $2 \mod 12$ 是同余的。

我们可以用另一种方式来思考这个问题，如果两个数 $a$ 和 $b$ 的差值 $a - b$ 能被 $m$
整除，那么这两个数 $a$ 和 $b$ 同余模 $m$ 。例如，$26$ 和 $2$ 同余模 $12$ ，
因为 $26 - 2 = 24$ 可以被 $12$ 整除。

## 0x02 模反元素（模逆元）

在普通数学中，每个数字都有一个 **倒数**。当与它相乘时，积为 $1$ 。用数学术语来说就是：
对于每个数字 $a$ 都有另一个 $b$ ，其中 $ab = 1$ 。通常我们可以说 $a$ 的倒数是 $\frac{1}{a}$ 。
例如，$7$ 的倒数是 $\frac{1}{7}$ 。

在模运算中，没有分数。我们不是找到满足 $ab = 1$ 的 $b$，而是找到满足 $ab \equiv 1 \mod m$
的 $b$ ，即：有一个整数 $a$ ，在给定模数 $m$ 下，存在一个整数 $b$ ，使得 $(a \cdot b) \\% m = 1$ 。
换句话说，$b$ 就是 $a$ 在模 $m$ 下的模反元素。这意味着对于不同的 $m$ 值，$a$ 有不同的
*模逆元（模倒数）* 。例如，$3 \mod 5$ 的模逆元是 $2$，因为 $3 \cdot 2 = 6 \equiv 1 \mod 5$，
因此我们也可以说 $3^{-1} \equiv 2 \mod 5$ 。

然而，并非每个数字 $a$ 都有模 $m$ 的模反元素。例如，$2$ 没有模 $6$ 的模反元素。这是
因为 $gcd(a, m) = 1$ 。让我们在一般情况下证明这一点，看看为什么会这样。

### 1x01 证明

假设存在 $b$ 使得 $a \cdot b \equiv 1 \mod m$ 。这意味着也存在 $c$ 使得 $ab = cm + 1$ ，
因此 $ab − cm = 1$ 。因此两边都可以被 $gcd(a, m)$ 整除，即 $gcd(a, m) = 1$ 。

因此，如果存在模 $m$ 的模反元素，则只有 $gcd(a, m) = 1$ 时才存在这样的模反元素。$\Box$

### 1x02 直观的方法

如果你正在努力想象这个证明，请回想一下前面的例子，$2$ 没有模 $6$ 的模反元素，为什么呢？
因为在模 $6$ 下 $2$ 的倍数的序列是 $0,2,4,0,2,4,...$ 并循环，没有任何整数 $b$ 可以满足
$(2 \cdot b) \\% 6 = 1$ ，因为它是 $6$ 的因数。

实际上，模反元素只在两个数互质（最大公约数为 $1$）的情况下存在。我们可以使用拓展欧几里得算法
来找到模反元素。但是对于像 $2$ 和 $6$ 这样有公因数的数，模反元素是不存在的，因为没有整数乘法
可以得到 $1$ 。如果我们选择 $4$ 而不是 $2$ ，我们可以看到这一点。如果有公因数（本例中为 $2$），
则不存在 $4x$ 会返回 $1$ 模 $6$ 的值 $x$ 。任何可以与 $4$ 相乘的数字在除以 $6$ 时始终会得到
可被 $2$ 整除的余数。

我建议你花一些时间思考这个事实，因为这是一个非常重要的结果。

### 1x03 用途

模逆元的用途与正则逆元的用途类似——即除法。通常，如果我们除两个数，我们可以将被除的数视为
*乘以它的倒数* 。

$$8 \div 2 = 8 \cdot 2^{-1} = 8 \cdot \frac{1}{2} = 4$$

我们可以以同样的方式使用模反元素——假设我们想将 $3$ 除以 $2$，模 $7$ ：

$$3 \div 2 \equiv 3 \cdot 2^{-1} \equiv 3 \cdot 4 \equiv 12 \equiv 5 \mod 7$$

就像这样，我们意识到 $3$ 除以 $2$ 模 $7$ 得到 $5$ 。

{{<admonition type="info">}}

注意：$4$ 是 $2$ 的模逆元，即 $2 \cdot 4 \equiv 1 \mod 7$ 。

{{</admonition>}}

